define(["underscore","backbone","../../core","../base","./stats"],function(e,i,s,t,n){var r=function(e){var i=s.config.get("fields.instances."+e.id+".type");return i?i:e.type?e.type:(i=e.simple_type,e.enumerable||"boolean"===i?"choice":i)},a=t.Model.extend({parse:function(){this._cache={};var e=t.Model.prototype.parse.apply(this,arguments);e.type=r(e);var i=this;return e.stats_capable&&(this.stats=new n.StatCollection,this.stats.url=function(){return i.links.stats}),e},distribution:function(e,s){if(s!==!1&&(s=!0),!this.links.distribution)return void e();if(s&&void 0!==this._cache.distribution)e(this._cache.distribution);else{var t=this;i.ajax({url:this.links.distribution,dataType:"json",success:function(i){return s&&(t._cache.distribution=i),e(i)}})}},dimensions:function(e,s){if(s!==!1&&(s=!0),!this.links.dimensions)return void e();if(s&&void 0!==this._cache.dimensions)e(this._cache.dimensions);else{var t=this;i.ajax({url:this.links.dimensions.uri,dataType:"json",success:function(i){return s&&(t._cache.dimensions=i),e(i)}})}},values:function(e,s,t){if(t!==!1&&(t=!0),"function"==typeof e?(s=e,t=s,e={}):e&&(t=!1,"string"==typeof e&&(e={query:e})),!this.links.values)return void s();var n=i.$.Deferred();if(s&&n.done(s),t&&void 0!==this._cache.values)n.resolve(this._cache.values);else{var r=this;i.ajax({url:this.links.values,data:e,dataType:"json",success:function(e){t&&(r._cache.values=e),n.resolve(e)},error:function(){n.reject()}})}return n.promise()}}),o=t.Collection.extend({model:a,search:function(s,t){i.ajax({url:e.result(this,"url"),data:{query:s},dataType:"json",success:function(e){t(e)}})}});return{FieldModel:a,FieldCollection:o}});
//# sourceMappingURL=base.js.map